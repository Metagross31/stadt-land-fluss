(this["webpackJsonpstadt-land-fluss"]=this["webpackJsonpstadt-land-fluss"]||[]).push([[0],{113:function(e,t,a){e.exports=a(137)},114:function(e,t,a){},119:function(e,t,a){},120:function(e,t,a){},125:function(e,t,a){},126:function(e,t,a){},130:function(e,t,a){},131:function(e){e.exports=JSON.parse('{"publishKey":"pub-c-cea13e04-e3aa-434b-806f-fc890fbd45bf","subscribeKey":"sub-c-66cfccd4-6c89-11ea-a7c4-5e95b827fd71"}')},132:function(e,t,a){},133:function(e,t,a){},135:function(e,t,a){},136:function(e,t,a){},137:function(e,t,a){"use strict";a.r(t),a.d(t,"appStore",(function(){return pt}));a(114);var n,r=a(0),i=a.n(r),o=a(10),l=a.n(o),s=a(60),u=a(12),c=a(13),p=a(15),d=a(16),m=(a(119),a(177)),h=a(55),f=a(39),g=(a(120),a(167)),v=a(102),y=a(186),b=a(101),E=a(81),I=a.n(E),C=a(82),O=a.n(C),S=a(83),R=a.n(S);!function(e){e.green="green",e.orange="orange",e.pink="pink"}(n||(n={}));var N,P=[{id:n.green,className:"green-theme",displayName:"Gr\xfcn",muiTheme:Object(b.a)({palette:{primary:I.a}})},{id:n.orange,className:"orange-theme",displayName:"Orange",muiTheme:Object(b.a)({palette:{primary:O.a}})},{id:n.pink,className:"pink-theme",displayName:"Pink",muiTheme:Object(b.a)({palette:{primary:R.a}})}],w=a(23),j=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={anchorEl:null},e.handleClick=function(t){e.setState({anchorEl:t.currentTarget})},e.handleClose=function(t){e.setState({anchorEl:null})},e.handleMenuItemClick=function(t){e.setState({anchorEl:null}),e.props.switchTheme(t)},e}return Object(c.a)(a,[{key:"render",value:function(){var e=this,t=i.a.createElement("p",null,"Spieler: ",this.props.playerName?this.props.playerName:"-");return i.a.createElement("header",{className:"app-header "+this.props.theme.className},i.a.createElement("h1",null,"Stadt-Land-Fluss"),t,i.a.createElement(g.a,{className:"color-picker-button","aria-controls":"color-picker-menu","aria-haspopup":"true",onClick:this.handleClick},"Theme"),i.a.createElement(v.a,{id:"color-picker-menu",anchorEl:this.state.anchorEl,keepMounted:!0,open:Boolean(this.state.anchorEl),onClose:this.handleClose},P.map((function(t,a){return i.a.createElement(y.a,{key:"color-picker-menu-item-"+a,onClick:function(){return e.handleMenuItemClick(t)}},t.displayName)}))))}}]),a}(r.Component),k=Object(w.b)((function(e){return{playerName:e.playerInfo?e.playerInfo.name:""}}))(j),A=(a(125),a(172)),T=(a(126),a(171)),F=function(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement("h2",{className:"section-header"},e.text),e.showDivider?i.a.createElement(T.a,null):null)},x=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){return i.a.createElement("div",{className:"main-content-wrapper"},i.a.createElement("div",{className:"dashboard-container material-card-style"},i.a.createElement(F,{showDivider:!0,text:"Dashboard"}),i.a.createElement("div",{className:"link-container"},i.a.createElement(A.a,{component:h.b,to:"/newgame"},"Neues Spiel"),i.a.createElement(A.a,{component:h.b,to:"/joingame"},"Spiel beitreten"))))}}]),a}(r.Component),D=a(87),M=a.n(D),G=a(38),L=a(86),_=a.n(L),z=a(33),W=function(e){if(e>23)throw new Error("Cannot create more than 23 randomn unique letters of the alphabet (without Q, X and Y)!");for(var t=[],a=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","R","S","T","U","V","W","Z"],n=function(e){var n=_()(a);t.push(n),a=a.filter((function(e){return e!==n}))},r=0;r<e;r++)n();return t},K=function(e){return e.map((function(e){return Object(G.a)({},e,{valid:!!e.text})}))},B=function(e,t){var a=new Map;return e.forEach((function(n){var r=[];t.forEach((function(t){var a=new Map;e.forEach((function(e){a.set(e.id,!0)})),r.push(a)})),a.set(n.id,r)})),a},H=function(e){return e<=3?1:2},V=function(e){var t=0;return e.forEach((function(e){return t=e?t:t+1})),t},q=function(e,t,a){var n=Object(z.cloneDeep)(e);return n.forEach((function(e,n){for(var r=t.get(n),i=0;i<e.length;i++)e[i].valid&&(e[i].valid=V(r[i])<a)})),n},J=function(e,t){var a=[],n={};return e.forEach((function(e,t){return n[t]={playerName:e.name,points:0}})),t.forEach((function(e){e.forEach((function(e,t){var a=e.reduce((function(e,t){return t.valid?e+1:e}),0);n[t].points+=a}))})),Object.keys(n).forEach((function(e){return a.push(n[e])})),a.sort((function(e,t){return t.points-e.points}))},U=function(e){return{type:"SET_DATA_FOR_NEW_GAME",payload:e}},Q=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={gameResults:[]},e.returnToDashboard=function(){e.props.history.push("/"),e.props.onResetAppState()},e}return Object(c.a)(a,[{key:"render",value:function(){if(null===this.props.gameRounds)return null;var e=this.props.gameConfig;return i.a.createElement("div",{className:"main-content-wrapper"},i.a.createElement("div",{className:"material-card-style"},i.a.createElement(F,{showDivider:!0,text:"Ergebnis"}),this.state.gameResults.map((function(e,t){return i.a.createElement("p",{key:"results-for-player-"+t},e.playerName,": ",e.points)}))),i.a.createElement("div",{className:"material-card-style"},i.a.createElement(F,{showDivider:!0,text:"Spiel-Settings"}),i.a.createElement("h3",null,"Spiele-Settings:"),i.a.createElement("p",null,"Runden: ",e.numberOfRounds),i.a.createElement("p",null,"Kategorien: ",e.categories.join(", "))),i.a.createElement("div",{className:"button-wrapper add-margin-top"},i.a.createElement(g.a,{type:"button",color:"primary",variant:"contained",size:"large",startIcon:i.a.createElement(M.a,null),onClick:this.returnToDashboard},"Dashboard")))}},{key:"componentDidMount",value:function(){null!==this.props.allPlayers&&null!==this.props.gameRounds?this.setState({gameResults:J(this.props.allPlayers,this.props.gameRounds)}):this.props.history.push("/")}}]),a}(r.Component),X=Object(w.b)((function(e){return e}),(function(e){return{onResetAppState:function(){e({type:"RESET_APP_STATE"})}}}))(Q),Y=a(64),Z=(a(130),a(178)),$=a(88),ee=a.n($),te=a(181),ae=a(131),ne={publishKey:ae.publishKey,subscribeKey:ae.subscribeKey,uuid:Object(te.a)(),ssl:!0},re=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={idInput:"",nameInput:"",validateInputs:!1},e.handleInputChange=function(t){var a=t.target,n=a.name,r=a.value;e.setState(Object(Y.a)({},n,r))},e.handleSubmit=function(t){t.preventDefault(),e.setState({validateInputs:!0}),e.state.idInput&&e.state.nameInput&&(e.props.onSetGameData({gameConfig:null,gameId:e.state.idInput,playerInfo:{id:ne.uuid,isAdmin:!1,name:e.state.nameInput}}),e.props.history.push("/play"))},e}return Object(c.a)(a,[{key:"render",value:function(){var e=i.a.createElement("form",{onSubmit:this.handleSubmit,className:"app-form",noValidate:!0,autoComplete:"off"},i.a.createElement(Z.a,{name:"idInput",label:"Spiel-ID",value:this.state.idInput,onChange:this.handleInputChange,className:"app-form-input",variant:"outlined",fullWidth:!0,required:!0,error:this.state.validateInputs&&!this.state.idInput}),i.a.createElement(Z.a,{name:"nameInput",label:"Spielername",value:this.state.nameInput,onChange:this.handleInputChange,className:"app-form-input",variant:"outlined",fullWidth:!0,required:!0,error:this.state.validateInputs&&!this.state.nameInput}),i.a.createElement("div",{className:"button-wrapper"},i.a.createElement(g.a,{type:"submit",color:"primary",variant:"contained",size:"large",startIcon:i.a.createElement(ee.a,null)},"Beitreten")));return i.a.createElement("div",{className:"main-content-wrapper"},i.a.createElement("div",{className:"material-card-style"},i.a.createElement(F,{showDivider:!0,text:"Spiel beitreten"}),e))}},{key:"componentDidMount",value:function(){var e=new URLSearchParams(this.props.location.search);e.has("id")&&this.setState({idInput:e.get("id")})}}]),a}(r.Component),ie=Object(w.b)(null,(function(e){return{onSetGameData:function(t){e(U(t))}}}))(re),oe=a(27),le=(a(132),a(91)),se=a.n(le),ue=a(183),ce=a(173),pe=a(184),de=a(90),me=a.n(de),he=a(89),fe=a.n(he);!function(e){e.available="available",e.selected="selected"}(N||(N={}));var ge,ve,ye=Object(ce.a)((function(e){return Object(pe.a)({root:{display:"flex",justifyContent:"center",flexWrap:"wrap",padding:e.spacing(.5)},chip:{margin:e.spacing(.5)}})})),be=function(e){var t=ye();return i.a.createElement("div",{className:t.root},e.chipsArray.map((function(a,n){return i.a.createElement(ue.a,{key:"chip-to-".concat(e.chipType,"-").concat(n),color:"selected"===e.chipType?"primary":void 0,label:a,className:t.chip,onDelete:function(){return e.removeChip(a)},deleteIcon:"selected"===e.chipType?i.a.createElement(fe.a,null):i.a.createElement(me.a,null)})})))},Ee=["Stadt","Land","Fluss"],Ie=["Band/Musiker","Beruf","Ber\xfchmte Person","Fiktiver Charakter","Film/Serie","Getr\xe4nk","Hobby","Krankheit","Laster","Marke","Mordwaffe","Pflanze","Scheidungsgrund","Sehensw\xfcrdigkeit","Speise","Tier"];!function(e){e.waitingToStart="waitingToStart",e.fillOutTextfields="fillOutTextfields",e.evaluateRound="evaluateRound",e.gameResult="gameResult"}(ge||(ge={})),function(e){e.available="available",e.selected="selected"}(ve||(ve={}));var Ce,Oe=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={availableCategories:Ie,nameInput:"",numberOfRoundsInput:3,selectedCategories:Ee,validateInputs:!1},e.handleNameInputChange=function(t){e.setState({nameInput:t.target.value})},e.handleNumberOfRoundsInputChange=function(t){var a=+t.target.value;a=(a=a<3?3:a)>10?10:a,e.setState({numberOfRoundsInput:a})},e.updateCategoryArrays=function(t,a){var n,r;a===ve.selected?(n=e.state.selectedCategories.filter((function(e){return e!==t})),(r=Object(oe.a)(e.state.availableCategories)).push(t)):(r=e.state.availableCategories.filter((function(e){return e!==t})),(n=Object(oe.a)(e.state.selectedCategories)).push(t)),e.setState({availableCategories:r,selectedCategories:n})},e.handleSubmit=function(t){if(t.preventDefault(),e.setState({validateInputs:!0}),e.state.nameInput&&e.state.selectedCategories.length>=3){var a=Object(te.a)(),n=W(e.state.numberOfRoundsInput);e.props.onSetGameData({gameConfig:{categories:e.state.selectedCategories,letters:n,numberOfRounds:e.state.numberOfRoundsInput},gameId:a,playerInfo:{id:ne.uuid,isAdmin:!0,name:e.state.nameInput}}),e.props.history.push("/play")}},e}return Object(c.a)(a,[{key:"render",value:function(){var e=this,t="Anzahl Runden (".concat(3,"-").concat(10,")"),a=i.a.createElement("form",{onSubmit:this.handleSubmit,className:"app-form",noValidate:!0,autoComplete:"off"},i.a.createElement(Z.a,{name:"nameInput",label:"Spielername",value:this.state.nameInput,onChange:this.handleNameInputChange,className:"app-form-input",variant:"outlined",fullWidth:!0,required:!0,error:this.state.validateInputs&&!this.state.nameInput}),i.a.createElement(Z.a,{name:"numberOfRoundsInput",label:t,type:"number",value:this.state.numberOfRoundsInput,onChange:this.handleNumberOfRoundsInputChange,variant:"outlined",fullWidth:!0,required:!0}),i.a.createElement("p",{className:"category-array-label"},"Ausgew\xe4hlte Kategorien:"),i.a.createElement(be,{chipsArray:this.state.selectedCategories,chipType:N.selected,removeChip:function(t){return e.updateCategoryArrays(t,ve.selected)}}),i.a.createElement("p",{className:"category-array-label"},"Verf\xfcgbare Kategorien:"),i.a.createElement(be,{chipsArray:this.state.availableCategories,chipType:N.available,removeChip:function(t){return e.updateCategoryArrays(t,ve.available)}}),i.a.createElement("div",{className:"button-wrapper add-margin-top"},i.a.createElement(g.a,{type:"submit",color:"primary",variant:"contained",size:"large",startIcon:i.a.createElement(se.a,null)},"Spiel erstellen")));return i.a.createElement("div",{className:"main-content-wrapper"},i.a.createElement("div",{className:"material-card-style"},i.a.createElement(F,{showDivider:!0,text:"Neues Spiel"}),a))}}]),a}(r.Component),Se=Object(w.b)(null,(function(e){return{onSetGameData:function(t){e(U(t))}}}))(Oe),Re=(a(133),a(92)),Ne=a.n(Re),Pe=a(66),we=a(174),je=Object(ce.a)((function(e){return Object(pe.a)({loadingScreen:{position:"absolute",top:"0",left:"0",height:"100%",width:"100%",backgroundColor:"rgba(0, 0, 0, 0.5)"},loadingSpinner:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}})})),ke=function(){var e=je();return i.a.createElement("div",{className:e.loadingScreen},i.a.createElement("div",{className:e.loadingSpinner},i.a.createElement(we.a,null)))},Ae=(a(135),a(185)),Te=a(179),Fe=a(176),xe=a(175),De=a(96),Me=a.n(De),Ge=a(94),Le=a.n(Ge),_e=Object(ce.a)((function(e){return Object(pe.a)({centerContent:{display:"flex",justifyContent:"center"},chip:{height:"3rem",marginTop:"1rem",borderRadius:"5px",fontSize:"1.2rem",boxShadow:"0 2px 4px rgba(0,0,0,.501961)"}})})),ze=function(e){var t=_e(),a=e.currentLetter,n=e.currentRound;return i.a.createElement("div",{className:t.centerContent},i.a.createElement(ue.a,{color:"primary",icon:i.a.createElement(Le.a,null),label:"Runde ".concat(n,": \u201e").concat(a,"\u201c"),className:t.chip}))},We=function(e){var t=e.allPlayers,a=e.currentRound,n=e.gameConfig,r=e.playerInfo,o=H(t.size),l=e.gameRounds[a-1],s=n.letters[a-1],u=Array.from(t).map((function(e){return e[1]}));u=u.sort((function(e,t){return e.name.charCodeAt(0)-t.name.charCodeAt(0)}));var c=function(t,a){var n=[r].concat(Object(oe.a)(u.filter((function(e){return e.id!==r.id})))),o=e.currentRoundEvaluation.get(u[a].id)[t];return i.a.createElement("div",{key:"slf-evaluation-checkboxes-wrapper-".concat(t,"-").concat(a),className:"slf-evaluation-checkboxes-wrapper"},n.map((function(n,l){return i.a.createElement(Ae.a,{key:"slf-evaluation-tooltip-".concat(t,"-").concat(a,"-").concat(l),title:n.name},i.a.createElement(Te.a,{key:"slf-evaluation-checkbox-".concat(t,"-").concat(a,"-").concat(l),color:n.id===r.id?"primary":"default",checked:!!o.get(n.id),inputProps:{"aria-label":"Best\xe4tigt von "+n.name},onChange:function(i){return function(t,a,n,i){if(a.id===r.id){var o=u[i];e.updateEvaluationOfPlayerInput({evaluatedPlayerId:o.id,categoryIndex:n,markedAsValid:t.target.checked})}}(i,n,t,a)}}))})))};return i.a.createElement(i.a.Fragment,null,i.a.createElement(ze,{currentLetter:s,currentRound:a}),i.a.createElement("form",{className:"app-form",noValidate:!0,autoComplete:"off"},n.categories.map((function(t,a){return i.a.createElement("div",{key:"slf-evaluation-for-category-no-"+a,className:"material-card-style"},i.a.createElement(F,{showDivider:!1,text:t}),u.map((function(t,n){return i.a.createElement("div",{key:"slf-evaluation-textfield-wrapper-".concat(a,"-").concat(n),className:"slf-evaluation-textfield-wrapper"},i.a.createElement(Z.a,{key:"slf-textfield-category-no-"+a+"-player-"+n,value:l.get(t.id)[a].text,className:"slf-evaluation-textfield",variant:"outlined",fullWidth:!0,InputProps:{startAdornment:i.a.createElement(Fe.a,{position:"start"},t.name,":"),className:V(e.currentRoundEvaluation.get(t.id)[a])>=o?"text-decoration-line-through":""}}),l.get(t.id)[a].text?c(a,n):null)})))})),i.a.createElement(xe.a,{type:"button",className:"fixed-bottom-right-button",color:"primary",title:"Akzeptieren","aria-label":"Akzeptieren",onClick:function(){return e.sendEvaluationFinishedMessage()}},i.a.createElement(Me.a,null))))},Ke=a(97),Be=a.n(Ke),He=function(e){var t=e.currentRound,a=e.gameConfig,n=e.gameRoundInputs,r=a.letters[t-1];return i.a.createElement(i.a.Fragment,null,i.a.createElement(ze,{currentLetter:r,currentRound:t}),i.a.createElement("form",{className:"app-form",noValidate:!0,autoComplete:"off"},a.categories.map((function(t,a){return i.a.createElement("div",{key:"slf-input-for-category-no-"+a,className:"material-card-style"},i.a.createElement(F,{showDivider:!1,text:t}),i.a.createElement(Z.a,{value:n[a].text,onChange:function(t){return function(t,a){var r=Object(oe.a)(n);r[a]=Object(G.a)({},r[a],{text:t.target.value}),e.updateCurrentRoundInputs(r)}(t,a)},variant:"outlined",fullWidth:!0,InputProps:{startAdornment:i.a.createElement(Fe.a,{position:"start"},r,":")}}))})),i.a.createElement(xe.a,{type:"button",className:"fixed-bottom-right-button",color:"primary",title:"Abschicken","aria-label":"Abschicken",onClick:function(){return e.sendRoundFinishedMessage()}},i.a.createElement(Be.a,null))))},Ve=a(100),qe=a.n(Ve),Je=(a(136),a(187)),Ue=a(98),Qe=a.n(Ue),Xe=function(e,t){return new Array(e).fill(t)},Ye=function(e){var t=window.location.origin+"/joingame?id="+e.gameId;return i.a.createElement(i.a.Fragment,null,i.a.createElement("p",{className:"join-game-link-label"},"Teile diesen Link mit Freunden:"),i.a.createElement(Je.a,{name:"idInput",value:t,className:"app-form-input",disabled:!0,fullWidth:!0,endAdornment:i.a.createElement(Fe.a,{position:"end"},i.a.createElement(xe.a,{title:"Link kopieren","aria-label":"Link kopieren",onClick:function(){return function(e){var t=document.createElement("textarea");t.value=e,t.setAttribute("readonly",""),t.style.position="absolute",t.style.left="-9999px",document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}(t)}},i.a.createElement(Qe.a,null)))}))},Ze=a(99),$e=a.n(Ze),et=Object(ce.a)((function(e){return Object(pe.a)({root:{display:"flex",flexWrap:"wrap",padding:e.spacing(.5)},chip:{margin:e.spacing(.5)}})})),tt=function(e){var t=et(),a=[];return e.otherPlayers.forEach((function(e){return a.push(e.name)})),i.a.createElement("div",{className:t.root},a.map((function(e,a){return i.a.createElement(ue.a,{key:"player-name-".concat(a),icon:i.a.createElement($e.a,null),color:"primary",label:e,className:t.chip})})))};!function(e){e.startGame="startGame",e.roundFinished="roundFinished",e.currentRoundInputs="currentRoundInputs",e.evaluationOfPlayerInput="evaluationOfPlayerInput",e.evaluationFinished="evaluationFinished"}(Ce||(Ce={}));var at=function(){function e(t){Object(u.a)(this,e),this.payload=t}return Object(c.a)(e,[{key:"toPubNubMessage",value:function(){return{type:Ce.currentRoundInputs,payload:this.payload}}}]),e}(),nt=function(){function e(t){Object(u.a)(this,e),this.payload=t}return Object(c.a)(e,[{key:"toPubNubMessage",value:function(){return{type:Ce.evaluationOfPlayerInput,payload:this.payload}}}]),e}(),rt=function(e){var t=e.gameId,a=e.otherPlayers,n=e.playerInfo,r=i.a.createElement("p",null,"Warte auf Spielbeginn...");return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"material-card-style"},i.a.createElement(F,{showDivider:!0,text:"Gleich geht's los..."}),i.a.createElement("h3",{className:"other-players-headline"},"Mitspieler:"),i.a.createElement(tt,{otherPlayers:e.otherPlayers}),e.gameConfig?function(){var t=e.gameConfig;return i.a.createElement(i.a.Fragment,null,i.a.createElement(T.a,null),i.a.createElement("h3",null,"Spiele-Settings:"),i.a.createElement("p",null,"Runden: ",t.numberOfRounds),i.a.createElement("p",null,"Kategorien: ",t.categories.join(", ")))}():null,i.a.createElement(T.a,null),n.isAdmin?i.a.createElement("div",{className:"button-wrapper add-margin-top"},i.a.createElement(g.a,{color:"primary",variant:"contained",size:"large",startIcon:i.a.createElement(qe.a,null),disabled:a.size<1,onClick:function(){return e.sendMessage({type:Ce.startGame})}},"Starten")):r),n.isAdmin?i.a.createElement("div",{className:"material-card-style"},i.a.createElement(Ye,{gameId:t})):null)},it=i.a.memo((function(e){var t=Object(Pe.b)(),a=function(){var a;a=e.playerInfo.isAdmin?{gameConfig:e.gameConfig,playerInfo:e.playerInfo}:{playerInfo:e.playerInfo},t.setState({channels:[e.gameChannel],state:a})},n=function(){t.hereNow({channels:[e.gameChannel],includeUUIDs:!0,includeState:!0},(function(t,a){console.log("PubNub hereNow",a);var n=a.channels[e.gameChannel];n&&e.addPlayers.apply(e,Object(oe.a)(n.occupants.map((function(e){return e.state}))))}))};return Object(r.useEffect)((function(){var r={message:function(t){console.log("PubNub message event",t);var a=t.message;switch(a.type){case Ce.startGame:e.startGame();break;case Ce.roundFinished:e.stopRoundAndSendInputs();break;case Ce.currentRoundInputs:e.addPlayerInputForFinishedRound(t.publisher,a.payload);break;case Ce.evaluationOfPlayerInput:e.processEvaluationOfPlayerInput(t.publisher,a.payload);break;case Ce.evaluationFinished:e.countPlayerAsEvaluationFinished(t.publisher)}},presence:function(t){if(console.log("PubNub presence event",t),"state-change"===t.action){var a=t.state;a.playerInfo.id!==e.playerInfo.id&&e.addPlayers(a)}},status:function(r){console.log("PubNub status event",r),"PNConnectedCategory"===r.category&&(console.log("Player is connected to PubNub game channel"),t.history({channel:e.gameChannel,count:10},(function(t,r){r.messages.length>0?e.navigateToDashboard():(a(),e.playerInfo.isAdmin||n())})))}};return t.addListener(r),t.subscribe({channels:[e.gameChannel],withPresence:!0}),function(){t.removeListener(r),t.unsubscribeAll()}})),null})),ot=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={allPlayers:new Map,currentPhase:ge.waitingToStart,currentRoundEvaluation:new Map,currentRoundInputs:[],currentRound:1,gameConfig:null,gameRounds:[],playersThatFinishedEvaluation:new Map,showLoadingScreen:!0},e.pubNubClient=new Ne.a(ne),e.sendMessage=function(t){e.pubNubClient.publish({channel:e.props.gameId,message:t,storeInHistory:!0,ttl:1},(function(e,t){return console.log("PubNub Publish:",e,t)}))},e.navigateToDashboard=function(){e.props.history.push("/"),e.props.onResetAppState()},e.addPlayers=function(){if(e.state.currentPhase===ge.waitingToStart){for(var t=null,a=Object(z.cloneDeep)(e.state.allPlayers),n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach((function(e){a.set(e.playerInfo.id,e.playerInfo),e.gameConfig&&(t=e.gameConfig)})),t?e.setState({allPlayers:a,gameConfig:t,showLoadingScreen:!1}):e.setState({allPlayers:a})}},e.startGame=function(){var t=e.state.gameConfig,a=Xe(t.categories.length,{text:"",valid:!0});e.setState({currentPhase:ge.fillOutTextfields,currentRoundInputs:a})},e.updateCurrentRoundInputs=function(t){e.setState({currentRoundInputs:t})},e.sendRoundFinishedMessage=function(){e.setState({showLoadingScreen:!0}),e.sendMessage({type:Ce.roundFinished})},e.stopRoundAndSendInputs=function(){var t=[].concat(Object(oe.a)(e.state.gameRounds),[new Map]),a=B(e.state.allPlayers,e.state.gameConfig.categories);e.setState({currentRoundEvaluation:a,gameRounds:t,showLoadingScreen:!0});var n=new at(K(e.state.currentRoundInputs));e.sendMessage(n.toPubNubMessage())},e.addPlayerInputForFinishedRound=function(t,a){var n=Object(z.cloneDeep)(e.state.gameRounds);n[e.state.currentRound-1].set(t,a),n[e.state.currentRound-1].size===e.state.allPlayers.size?e.setState({currentPhase:ge.evaluateRound,gameRounds:n,showLoadingScreen:!1}):e.setState({gameRounds:n})},e.updateEvaluationOfPlayerInput=function(t){var a=new nt(t);e.sendMessage(a.toPubNubMessage())},e.processEvaluationOfPlayerInput=function(t,a){var n=Object(z.cloneDeep)(e.state.currentRoundEvaluation),r=n.get(a.evaluatedPlayerId);r&&r[a.categoryIndex].set(t,a.markedAsValid),e.setState({currentRoundEvaluation:n})},e.sendEvaluationFinishedMessage=function(){e.setState({showLoadingScreen:!0}),e.sendMessage({type:Ce.evaluationFinished})},e.countPlayerAsEvaluationFinished=function(t){var a=Object(z.cloneDeep)(e.state.playersThatFinishedEvaluation);a.set(t,!0),a.size===e.state.allPlayers.size?e.processEvaluationsAndStartNextRoundOrFinishGame():e.setState({playersThatFinishedEvaluation:a})},e.processEvaluationsAndStartNextRoundOrFinishGame=function(){var t=e.state,a=t.allPlayers,n=t.currentRound,r=t.currentRoundEvaluation,i=t.gameRounds,o=e.state.gameConfig,l=Object(z.cloneDeep)(i);l[n-1]=q(i[n-1],r,H(a.size)),n===o.numberOfRounds?(e.props.onSetDataOfFinishedGame({allPlayers:a,gameConfig:o,gameRounds:l}),e.props.history.push("/results")):e.setState({currentPhase:ge.fillOutTextfields,currentRoundEvaluation:B(a,o.categories),currentRoundInputs:Xe(o.categories.length,{text:"",valid:!0}),currentRound:n+1,gameRounds:l,playersThatFinishedEvaluation:new Map,showLoadingScreen:!1})},e}return Object(c.a)(a,[{key:"render",value:function(){if(null===this.props.gameId)return null;var e=this.props,t=e.gameId,a=e.playerInfo,n=Object(z.cloneDeep)(this.state.allPlayers);n.delete(a.id);var r=null;return this.state.currentPhase===ge.waitingToStart&&(r=i.a.createElement(rt,{gameConfig:this.state.gameConfig,gameId:t,otherPlayers:n,playerInfo:a,sendMessage:this.sendMessage})),this.state.currentPhase===ge.fillOutTextfields&&(r=i.a.createElement(He,{currentRound:this.state.currentRound,gameConfig:this.state.gameConfig,gameRoundInputs:this.state.currentRoundInputs,updateCurrentRoundInputs:this.updateCurrentRoundInputs,sendRoundFinishedMessage:this.sendRoundFinishedMessage})),this.state.currentPhase===ge.evaluateRound&&(r=i.a.createElement(We,{allPlayers:this.state.allPlayers,currentRound:this.state.currentRound,currentRoundEvaluation:this.state.currentRoundEvaluation,gameConfig:this.state.gameConfig,gameRounds:this.state.gameRounds,playerInfo:a,updateEvaluationOfPlayerInput:this.updateEvaluationOfPlayerInput,sendEvaluationFinishedMessage:this.sendEvaluationFinishedMessage})),i.a.createElement(Pe.a,{client:this.pubNubClient},i.a.createElement(it,{gameChannel:this.props.gameId,gameConfig:this.props.gameConfig,playerInfo:this.props.playerInfo,navigateToDashboard:this.navigateToDashboard,addPlayers:this.addPlayers,startGame:this.startGame,stopRoundAndSendInputs:this.stopRoundAndSendInputs,addPlayerInputForFinishedRound:this.addPlayerInputForFinishedRound,processEvaluationOfPlayerInput:this.processEvaluationOfPlayerInput,countPlayerAsEvaluationFinished:this.countPlayerAsEvaluationFinished}),this.state.showLoadingScreen?i.a.createElement(ke,null):i.a.createElement("div",{className:"main-content-wrapper"},r))}},{key:"componentDidMount",value:function(){if(null!==this.props.gameId){var e=Object(z.cloneDeep)(this.state.allPlayers);e.set(this.props.playerInfo.id,this.props.playerInfo),this.props.playerInfo.isAdmin?this.setState({allPlayers:e,gameConfig:this.props.gameConfig,showLoadingScreen:!1}):this.setState({allPlayers:e})}else this.props.history.push("/")}}]),a}(r.Component),lt=Object(w.b)((function(e){return{gameConfig:e.gameConfig,gameId:e.gameId,playerInfo:e.playerInfo}}),(function(e){return{onSetDataOfFinishedGame:function(t){e(function(e){return{type:"SET_DATA_OF_FINISHED_GAME",payload:e}}(t))},onResetAppState:function(){e({type:"RESET_APP_STATE"})}}}))(ot),st=function(e){return localStorage.setItem("SLF-APP-THEME",e)},ut=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={activeTheme:P[0]},e.switchThemeHandler=function(t){e.setState({activeTheme:t}),st(t.id)},e}return Object(c.a)(a,[{key:"render",value:function(){return i.a.createElement(m.a,{theme:this.state.activeTheme.muiTheme},i.a.createElement("div",{className:"app-container"},i.a.createElement(k,{theme:this.state.activeTheme,switchTheme:this.switchThemeHandler}),i.a.createElement(h.a,null,i.a.createElement("main",{className:"app-main "+this.state.activeTheme.className},i.a.createElement(f.a,{path:"/",exact:!0,component:x}),i.a.createElement(f.a,{path:"/newgame",exact:!0,component:Se}),i.a.createElement(f.a,{path:"/joingame",exact:!0,component:ie}),i.a.createElement(f.a,{path:"/play",exact:!0,component:lt}),i.a.createElement(f.a,{path:"/results",exact:!0,component:X})))))}},{key:"componentDidMount",value:function(){var e=localStorage.getItem("SLF-APP-THEME");if(e){var t=P.find((function(t){return t.id===e}));t&&this.setState({activeTheme:t})}}}]),a}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ct={allPlayers:null,gameId:null,gameConfig:null,gameRounds:null,playerInfo:null},pt=Object(s.b)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ct,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_DATA_FOR_NEW_GAME":return Object(G.a)({},e,{},t.payload);case"SET_DATA_OF_FINISHED_GAME":return Object(G.a)({},e,{},t.payload,{gameId:null});case"RESET_APP_STATE":return Object(G.a)({},ct);default:return e}}));l.a.render(i.a.createElement(w.a,{store:pt},i.a.createElement(ut,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[113,1,2]]]);
//# sourceMappingURL=main.c1e76f63.chunk.js.map